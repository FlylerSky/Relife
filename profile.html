<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OREL — Profile</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">
  <link href="CSS/profile.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar bg-white shadow-sm py-2">
    <div class="container d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-3">
        <button id="menuToggleBtn" class="btn btn-light btn-sm"><i class="bi bi-list fs-4"></i></button>
        <a href="index.html" class="fw-bold">OREL</a>
      </div>

      <div class="search-box position-relative mx-2" style="flex:1; max-width:560px;">
        <div class="search-row">
          <i class="bi bi-search small-muted ms-2"></i>
          <input id="profileSearchInput" class="form-control form-control-sm border-0" placeholder="Tìm trong bài viết của người này..." aria-label="search">
        </div>
        <div id="profileSearchResults" class="search-results"></div>
      </div>

      <div class="d-flex align-items-center gap-2">
        <div class="small-muted">Profile</div>
      </div>
    </div>
  </nav>

  <!-- Offcanvas menu -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="profileMenuCanvas">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Menu</h5>
      <button class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <div id="menuAuthAreaProfile" class="mb-3"></div>

      <button id="openAchievementsBtn" class="btn btn-outline-secondary btn-rounded w-100 mb-2"><i class="bi bi-trophy"></i> Thành tích</button>

      <button id="openVisitorsBtn" class="btn btn-outline-secondary btn-rounded w-100 mb-2" style="display:none;"><i class="bi bi-people"></i> Khách ghé thăm</button>

      <a href="index.html" class="btn btn-outline-secondary btn-rounded w-100 mb-2"><i class="bi bi-house"></i> Trang chủ</a>

      <hr>
      <div class="small-muted">Phiên bản: <span class="badge-trial">V1.1</span></div>
    </div>
  </div>

  <div class="container my-4">
    <div id="profileArea" class="card p-3">
      <div id="profileLoading" class="text-center text-muted py-4">Đang tải...</div>
    </div>
  </div>

  <!-- Comments Modal (used by profile posts) -->
  <div class="modal fade" id="profileCommentsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h6 id="profileCommentsTitle">Bình luận</h6>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="profileCommentsList" class="mb-3"></div>
          <div id="profileMustLoginToComment" class="alert alert-warning" style="display:none;">Bạn cần <a href="#" id="openLoginFromProfileComment">đăng nhập</a> để bình luận.</div>
          <div id="profileCommentBoxArea" style="display:none;">
            <div id="profileCommenterInfo" class="mb-2"></div>
            <textarea id="profileCommentText" class="form-control mb-2" rows="3" placeholder="Viết bình luận..."></textarea>
            <div class="d-flex justify-content-end"><button id="profilePostCommentBtn" class="btn btn-primary btn-rounded">Gửi bình luận</button></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Achievements Modal -->
  <div class="modal fade" id="achievementsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="bi bi-trophy-fill text-warning"></i> Thành tích</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="achievementsContainer" class="row g-3"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Visitors Modal -->
  <div class="modal fade" id="visitorsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="bi bi-people-fill"></i> Khách ghé thăm</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="visitorsList" class="list-group"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Post Modal (Quill editor) -->
  <div class="modal fade" id="postEditorModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <form id="postEditorForm" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="postEditorTitle">Viết / Chỉnh sửa bài</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input id="editorPostTitle" class="form-control mb-2" placeholder="Tiêu đề" required>
          <div id="editorQuill" style="min-height:180px;"></div>
          <input id="editorPostHashtags" class="form-control mt-2" placeholder="#tag1 #tag2">
          <input type="hidden" id="editorPostId" value="">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary btn-rounded" data-bs-dismiss="modal">Hủy</button>
          <button type="submit" class="btn btn-primary btn-rounded">Lưu</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Minimal Login Modal (for profile) -->
  <div class="modal fade" id="loginModalProfile" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <form id="loginFormProfile" class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Đăng nhập</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input id="loginEmailProfile" type="email" class="form-control mb-2" placeholder="Email" required>
          <input id="loginPasswordProfile" type="password" class="form-control mb-2" placeholder="Mật khẩu" required>
          <div id="activateBlockProfile" style="display:none;">
            <hr>
            <div class="form-text mb-2">Tài khoản chưa kích hoạt. Nhập mã kích hoạt do admin gửi:</div>
            <input id="activationCodeProfile" class="form-control mb-2" placeholder="Mã kích hoạt">
            <div id="activateHelpProfile" class="form-text small-muted"></div>
          </div>
        </div>
        <div class="modal-footer"><button type="button" class="btn btn-secondary btn-rounded" data-bs-dismiss="modal">Hủy</button><button type="submit" class="btn btn-primary btn-rounded">Đăng nhập</button></div>
      </form>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.min.js"></script>

  <!-- Module script -->
  <script type="module" src="JS/profile.js"></script>
</body>
</html>
